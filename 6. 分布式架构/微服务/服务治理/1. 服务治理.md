## 1. 服务治理

#### 1.1 基础介绍

- 服务治理是指对一个分布式系统（ 特别是微服务架构中 ）的一系列策略和实践，以确保系统中的各个服务能够高效、稳定地运行。服务治理通过对服务的注册与发现、服务监控、服务路由与负载均衡等操作进行统一管理，以提高系统的可用性、可扩展性、容错性和安全性

#### 1.2 主要能力

- API 网关（ 过滤 ）
  - API 网关是微服务系统的统一入口，负责请求的路由、认证与鉴权、限流熔断等功能。API 网关可以简化服务间的通信，提供统一的安全策略和访问控制。常见的 API 网关组件有 Kong、Zuul、Istio 等
- 配置中心
  - 配置中心是用于统一管理各个服务的配置信息，使得配置的更新和发布更加简便。通过配置中心，可以实现动态配置，无需重启服务即可更新配置。常见的配置中心组件有 Spring Cloud Config、Consul KV 等
- 服务注册与发现
  - 服务注册是指服务实例在启动时将自己的信息（ 如 IP 地址、端口、版本等 ）注册到服务注册中心
  - 服务发现是指服务消费者通过查询服务注册中心获取服务提供者的信息，以实现服务间的通信。这样可以实现动态服务发现和负载均衡，减少硬编码和手动配置
  - 常见的服务注册与发现组件有 Consul、Eureka、Zookeeper 等
- 服务路由与负载均衡
  - 服务路由指将请求分发到合适的服务实例上
  - 负载均衡是在服务路由的基础上，根据某种策略（ 如 轮询、随机、最小连接数 等 ）将请求分发到不同的服务实例，以实现负载的均衡分配。负载均衡有助于提高系统的可扩展性和可用性。常见的负载均衡组件有 Nginx、HAProxy、Envoy 等
- 服务监控与链路追踪
  - 服务监控是对微服务系统中各个服务的运行状况进行实时监控。包括服务的性能指标（ 如响应时间、吞吐量等 ）、资源利用率（ 如 CPU、内存、磁盘等）、错误和异常等。服务监控可以帮助运维人员及时发现问题、对系统进行调优和故障排除。常见的服务监控工具有 Prometheus、Grafana、ELK（ Elasticsearch、Logstash、Kibana ）等
  - 链路追踪是对微服务系统中服务调用链路进行跟踪和分析。通过收集和分析链路上的调用数据，可以更好地理解服务间的依赖关系，优化系统性能，以及定位故障原因。常见的服务链路追踪工具有 Zipkin、Jaeger 等
- 服务熔断与降级
  - 服务熔断是一种保护机制，当某个服务出现故障或响应过慢时，熔断器会自动切断对该服务的调用，以防止故障的蔓延
  - 服务降级是在某个服务出现问题时，将其功能降级为简化版，以保证核心业务的可用性
  - 这两种机制都有助于提高系统的容错性和稳定性。常见的熔断与降级组件有 Hystrix、Resilience4j 等

## 2. API 网关（ 过滤 ）

#### 2.1 基础介绍

- API 网关在微服务架构中作为一个独立的组件存在，类似于一个门户，位于微服务实例之外，用于接收和处理外部请求。网关将所有服务的 API 接口资源统一聚合，对外统一暴露，并提供一些功能和保护机制。而流量路由通常是在每个服务实例内部进行，是一种在内部使用的技术机制，用于将请求导向不同的后端服务
- API 网关为客户端提供了一个统一的接入点，使得客户端只需与 API 网关通信，而无需了解后端服务的具体细节直接。这简化了客户端的开发和部署，同时也提供了更好的可扩展性和灵活性
  ![image](https://img-blog.csdnimg.cn/49b61a53bf1d4f7ebc92ddbf9842fbec.png)

#### 2.2 常用功能

- 令牌验证：
  - API 网关可以使用令牌验证过滤器来验证请求中的访问令牌或身份认证令牌的有效性。这有助于确保只有持有有效令牌的请求能够通过 API 网关并访问后端服务
  - 令牌验证过滤器可以通过与身份验证服务进行交互，验证令牌的签名、有效期等信息，从而提供安全的访问控制
- 监控和分析：
  - API 网关通常提供访问日志和审计功能，可以记录请求和响应的详细信息
  - 这些日志可以包括请求的来源 IP、HTTP 方法、路径、参数、响应状态码等。还会收集性能指标和错误信息
  - 通过记录和审计这些信息，可以进行故障排除、安全审计、性能分析等操作，帮助追踪和调查潜在的问题或安全事件
- 速率限制：
  - API 网关可以使用速率限制过滤器来限制对后端服务的请求速率，防止过度使用或恶意使用
  - 速率限制可以基于时间窗口、用户身份、API 密钥等进行配置
- 实施熔断机制：
  - 即在后端服务出现故障或过载时，暂时停止将请求转发给后端服务，以保护后端服务的稳定性
- 安全过滤和防护：
  - API 网关可以使用各种安全过滤器来检测和阻止恶意请求，如 SQL 注入、跨站脚本攻击等
  - 它可以在请求到达后端服务之前对其进行拦截，并进行有效的防护措施。这有助于减少对后端服务的安全风险
- 请求转换和响应整合：
  - API 网关可以对请求和响应进行格式转换和整合
  - 它可以根据后端服务的接口要求，对请求进行参数映射、数据格式转换等操作，确保请求与后端服务相兼容。类似地，它也可以将多个后端服务的响应进行整合，并返回给客户端
- 缓存和性能优化：
  - API 网关可以使用缓存策略来缓存后端服务的响应，以降低对后端服务的访问次数，提高系统性能和响应速度
  - 它可以根据请求的特征、数据有效期等因素来灵活配置缓存策略，以提升用户体验
- 多版本管理：
  - API 网关还可以管理不同版本的后端服务，并通过流量路由将请求发送到特定版本
  - 这对于系统的演进和迭代非常有用，可以实现平滑的 API 升级和切换

## 3. 配置中心

- 配置中心通常作为一个独立的服务，提供了一种集中化的方式来存储、更新和分发应用程序的配置，并使得应用程序能够动态地获取最新的配置。将配置管理与应用程序解耦，并提供更好的可维护性和可扩展性
- 配置中心的服务流程如下：
  - 用户在配置中心更新配置信息
  - 服务 A 和服务 B 及时得到配置更新通知，从配置中心获取配置
- 一个合格的配置中心通常需要满足如下特性：
  - 配置项容易读取和修改
  - 分布式环境下应用配置的可管理性，即提供远程管理配置的能力
  - 支持对配置的修改的检视以把控风险
  - 可以查看配置修改的历史记录

## 4. 服务注册中心

#### 4.1 核心概念

- 也可以叫命名服务，在分布式系统中，通常需要一个全局唯一的名字，需要去注册中心去注册一个唯一名字
- 服务注册中心（ Registry ）：
  - 服务注册中心是一个独立的组件（ 服务实例 ），用于接收、存储和管理各个微服务实例的信息
  - 每个微服务实例在启动时，会将自己的元数据（ 如主机地址、端口号、服务名称、健康状态等 ）注册到服务注册中心
  - 服务注册中心负责维护这些注册信息，并提供查询接口供其他服务使用
  - 当 RPC Server 节点发生变更时，Registry 会同步变更，RPC Client 感知后会刷新本地 内存中缓存的服务节点列表
- 服务提供者（ RPC Server ）：
  - 服务提供者是指提供具体功能服务的微服务实例
  - 当服务提供者启动时，它会向服务注册中心注册自己的信息，包括所提供的服务名称、主机地址、端口号等
  - 服务提供者将自己标识为某个服务的提供者，以便其他服务能够发现和调用它
  - 向 Registry 定期发送心跳汇报存活状态
- 服务消费者（ RPC Client ）：
  - 服务消费者是指需要使用某个服务的微服务实例
  - 服务消费者在运行时通过查询服务注册中心，根据服务名称找到可用的服务提供者的信息
  - 然后，服务消费者可以利用这些信息建立通信和调用服务提供者的接口，以完成具体的业务逻辑
  - 把 Registry 返回的服务节点列表缓存在本地内存中，并与 RPC Sever 建立连接

#### 4.2 工作流程

- 工作流程如下
  ![image](https://img-blog.csdnimg.cn/ba197635b878449aa10bed6842110b09.png)
  - 服务提供者启动时，会将其服务名称，IP 地址注册到配置中心
  - 服务消费者在第一次调用服务时，会通过注册中心找到相应的服务的 IP 地址列表，并缓存到本地，以供后续使用。当消费者调用服务时，不会再去请求注册中心，而是直接通过负载均衡算法从 IP 列表中取一个服务提供者的服务器调用服务
  - 当服务提供者的某台服务器宕机或下线时，相应的 IP 会从服务提供者 IP 列表中移除。同时，注册中心会将新的服务 IP 地址列表发送给服务消费者机器，缓存在消费者本机
  - 当某个服务的所有服务器都下线了，那么这个服务也就下线了
  - 同样，当服务提供者的某台服务器上线时，注册中心会将新的服务 IP 地址列表发送给服务消费者机器，缓存在消费者本机
  - 服务提供方可以根据服务消费者的数量来作为服务下线的依据

#### 4.3 需要实现功能

![image](https://img-blog.csdnimg.cn/1ea1cf922b2f459d9af1fa08a26914d8.png)

#### 4.4 优缺点

- 优点：
  - 动态性：服务注册与发现允许动态注册和发现服务实例，使得系统能够适应服务实例的变化，而无需手动配置每个服务的细节
  - 可伸缩性（对应增删服务实例）：通过服务注册与发现，当需要增加或减少服务实例时，系统可以自动更新服务提供者列表，并通知服务消费者。这样可以实现系统的弹性伸缩和负载均衡
  - 高可用性（对应服务实例故障）：通过服务注册与发现，系统能够检测并响应服务提供者的故障。当一个服务实例下线或发生故障时，系统可以将请求转发到其他可用的服务实例，从而提高系统的可用性和鲁棒性
  - 解耦合（对应修改服务实例）：服务注册与发现将服务提供者和服务消费者解耦合，使得它们之间的通信变得灵活、可替换和可扩展。服务提供者和消费者只需通过服务名称进行交互，而无需知道对方的具体位置和细节
- 缺点：
  - 单点故障：如果服务注册中心是单点的，那么它可能成为系统的单点故障。当服务注册中心不可用时，会影响服务提供者和消费者之间的通信和调用。
  - 增加复杂性：引入服务注册与发现机制会增加系统的复杂性，特别是对于小规模的应用而言。需要额外的组件和配置来管理服务的注册和发现，增加了开发和维护的成本
  - 性能开销：使用服务注册与发现机制可能会导致一定的性能开销。服务消费者需要通过查询服务注册中心来获取可用的服务提供者列表，这可能会引入一定的延迟和网络开销
  - 安全性问题：在服务注册与发现的过程中，服务实例的元数据（如主机地址、端口号等）被暴露给其他服务。如果没有适当的安全措施，可能会导致信息泄漏和安全威胁

#### 4.5 实现方案

- 常见的服务注册与发现框架包括 Eureka、Consul、ZooKeeper 等
  - Eureka 是一个基于 RESTful 的服务发现组件，提供了服务注册和发现的功能
  - Consul 是一个开源的服务发现和配置共享平台，支持服务注册、健康检查和 KV 存储等特性
  - ZooKeeper 是一个分布式的协调服务，可以用于实现服务注册与发现、配置管理等功能

## 5. 元数据中心

- Dubbo 2.7 版本中引入的元数据中心，provider 实例启动后，会尝试将内部的 RPC 服务组织成元数据的格式到元数据中心，而 consumer 则在每次收到注册中心推送更新后，主动查询元数据中心
- 注意 consumer 端查询元数据中心的时机，是等到注册中心的地址更新通知之后。也就是通过注册中心下发的数据，我们能明确的知道何时某个实例的元数据被更新了，此时才需要去查元数据中心
- **与配置中心相反，从用户视角来看元数据中心是只读的**，元数据中心唯一的写入方是 Dubbo 进程实例，Dubbo 实例会在启动之后将一些内部状态（ 如服务列表、服务配置、服务定义格式等 ）上报到元数据中心，供一些治理能力作为数据来源，如服务测试、文档管理、服务状态展示等
- Dubbo 官方支持 Zookeeper、Nacos、Etcd、Redis 等元数据中心实现

## 6. 三大中心高可用

- 虽然三大中心已不再是 Dubbo 应用服务所必须的，但是在真实的生产环境中，一旦已经集成并且部署了该三大中心，三大中心还是会面临可用性问题，**Dubbo 需要保证三大中心高可用的部署架构**
- 在 Dubbo 中就支持多注册中心、多元数据中心、多配置中心，来满足同城多活、两地三中心、异地多活等部署架构模式的需求
- **Dubbo SDK 对三大中心都支持了 Multiple 模式**
- 多注册中心：
  - Dubbo 支持多注册中心，即一个接口或者一个应用可以被注册到多个注册中心中，比如可以注册到 ZK 集群和 Nacos 集群中，Consumer 也能够从多个注册中心中进行订阅相关服务的地址信息，从而进行服务发现
  - 通过支持多注册中心的方式来保证其中一个注册中心集群出现不可用时能够切换到另一个注册中心集群，保证能够正常提供服务以及发起服务调用。这也能够满足注册中心在部署上适应各类高可用的部署架构模式
- 多配置中心：
  - Dubbo 支持多配置中心，来保证其中一个配置中心集群出现不可用时能够切换到另一个配置中心集群，保证能够正常从配置中心获取全局的配置、路由规则等信息
  - 这也能够满足配置中心在部署上适应各类高可用的部署架构模式
- 多元数据中心：
  - Dubbo 支持多元数据中心，用于应对容灾等情况导致某个元数据中心集群不可用，此时可以切换到另一个元数据中心集群，保证元数据中心能够正常提供有关服务元数据的管理能力
- 拿注册中心举例，下面是一个多活场景的部署架构示意图：
  ![image](https://github.com/user-attachments/assets/1da6d320-3715-4db8-910a-fd85c444c3b1)

## 7. 服务路由与负载均衡

#### 7.1 服务路由

- 在服务治理中，服务路由是将请求导向到合适的服务实例或服务集群的过程，实现了请求的转发和分发的机制，例服务消费者通过服务名称，在众多服务中找到要调用的服务的地址列表
- 目的是根据请求的特性和目标，将请求正确地转发到相应的服务节点上，使得请求能够被正确处理并返回响应，从而保障系统的可用性、性能和可扩展性
- 服务路由可以根据多种条件进行决策，例如请求的协议、路径、参数、头部信息等。常见的服务路由方式包括
  - 基于请求的路由：根据请求的 URL 路径或参数来判断将请求路由到哪个具体的服务实例
  - 基于协议的路由：根据请求使用的协议（ 如 HTTP、gRPC 等 ）来选择相应的服务实例
  - 基于头部信息的路由：根据请求的头部信息（ 如用户认证信息、版本号等 ）来选择合适的服务实例
  - 基于负载情况的路由：根据服务实例的负载情况（ 如 CPU、内存、网络等 ）来选择负载较低的实例，以实现负载均衡
  - 动态路由：根据运行时的环境和配置变化，动态地调整路由策略，以适应不同的场景和需求
- 实现服务路由的方式有多种，可以通过配置中心、API 网关、反向代理等来实现

#### 7.2 负载均衡

- 服务治理中的负载均衡是一种将请求均匀地分布到多个后端服务实例上的技术，在请求到来时，为了将请求均衡地分配到服务器，负载均衡程序将从服务对应的可用地址列表中，通过相应的负载均衡算法和规则，选取一台服务器进行访问，这个过程称为服务的负载均衡

#### 7.3 流量路由

- 流量路由是指使用了负载均衡策略的服务路由
- 一般使用第三方库，不会导入实现 负载均衡 的库，而是会直接导入 流量路由 的具体实现，封装好了 负载均衡 操作

## 8. 服务监控与链路追踪

#### 8.1 服务监控

- 服务监控用于实时监测和度量系统内各个服务的运行状态、性能指标和异常情况。它提供了对系统运行情况的细粒度可见性，帮助管理员及时发现问题、进行故障排查和性能优化

#### 8.2 常见的服务监控内容：

- 系统指标监控：
  - 监控服务所在的系统的一些关键指标，如 CPU 使用率、内存占用、磁盘空间、网络流量等
  - 这些指标可以帮助及时发现系统资源的瓶颈和异常情况，以便进行相应的调整和优化
- 服务性能监控：
  - 监控服务的性能指标，如响应时间、请求吞吐量、并发连接数等
  - 通过实时监控和分析这些指标，可以及时发现性能问题和瓶颈，并进行优化
  - 同时，可以设置阈值，当性能指标超过设定的阈值时，触发警报或自动进行应急处理
- 异常监控：
  - 监控服务运行过程中的异常情况，如错误码、异常日志、服务崩溃等
  - 异常监控可以帮助及时发现问题，并进行故障排查和修复，保证服务的可用性和稳定性
- 错误率监控：
  - 监控服务的请求错误率，包括客户端请求错误和服务端处理错误等
  - 通过对错误率的监控可以及时发现服务中的问题，并及时采取措施进行修复和优化
- 实时日志监控：
  - 监控服务的日志输出，可以帮助追踪和分析请求的处理流程、排查问题和进行故障诊断
  - 实时日志监控可以结合日志分析工具，对大量的日志数据进行分析和挖掘，以获取更多有价值的信息
- 服务健康检查：
  - 定期或实时检查服务的可用性。通过主动向服务发送健康检查请求，并检查返回结果或状态码，可以判断服务是否正常运行
  - 当服务不可用时，可以及时采取措施如自动重启服务、切换到备用服务等
- 数据统计和报表：
  - 将监控得到的数据进行统计和分析，生成各种报表和可视化图表，以便更好地了解服务的运行情况和趋势。这些报表和图表可以提供给开发和运维人员参考，辅助决策和问题处理

#### 8.3 常见监控步骤：

- 监控指标类型：
  - 服务监控可以收集各种类型的指标信息。其中包括基本的系统健康状态（ 如服务是否运行、网络连接状态 ）、性能指标（ 如响应时间、请求吞吐量、错误率 ）、资源利用率（ 如 CPU 使用率、内存使用量、磁盘空间 ）等
  - 此外，还可以监控关键业务指标（如订单处理时间、支付成功率），以便及时发现业务问题
- 监控数据采集：
  - 服务监控通过主动或被动方式来采集监控数据
  - 主动采集通常涉及在不同层面插入监控代码、构建指标收集器，或直接利用框架和工具来收集数据
  - 被动采集则是通过监听和解析服务产生的日志、事件，或者通过接口和协议来获取指标数据
- 监控数据存储和处理：
  - 收集到的监控数据需要进行存储和处理，以便后续的分析和可视化展示
  - 常见的存储方式包括时间序列数据库、日志文件、消息队列等
  - 处理方面，可以进行数据清洗、聚合、计算统计指标、异常检测等操作
- 报警和通知机制：
  - 服务监控需要能够设置阈值，并及时发送报警和通知
  - 管理员可以根据具体需求配置报警规则，如某项指标超过或低于阈值时触发报警
  - 通知方式可以包括邮件、短信、即时消息等，以确保相关人员及时收到警报信息并采取相应的行动
- 监控数据可视化和仪表盘：
  - 为了方便管理员和开发人员查看监控数据，服务监控通常提供可视化和仪表盘功能
  - 通过图表、图形和表格等形式展示监控指标，可以更直观地了解系统的状态和趋势
  - 同时，也可以定制自定义仪表盘，集成多个系统的监控数据，进行综合性能分析
- 分布式系统监控：
  - 对于分布式系统，服务监控需要能够跨多个服务实例进行监控
  - 通过集中式的监控平台或分布式追踪系统，可以全面监控和分析整个系统的状态和性能
  - 这有助于识别系统中的瓶颈、性能瓶颈和请求链路问题
- 日志和事件监控：
  - 除了性能指标，服务监控还应该关注日志和事件的监控。监控日志和事件可以帮助发现系统的异常行为、错误信息和潜在的安全问题。通过对日志和事件进行收集、分析和告警，可以加快故障排查和问题解决的速度
- 自动化和智能化：
  - 随着人工智能和机器学习技术的发展，服务监控也可以应用自动化和智能化的方法。例如，利用机器学习算法进行异常检测和预测，自动调整监控阈值和报警规则，自动执行治理操作等

#### 8.4 链路追踪

- 链路追踪是一种用于跟踪和监测分布式系统中请求的流向和性能的技术。它通过在请求的各个组件中添加标识信息，并记录请求的调用关系和耗时等指标，从而实现对请求的全链路追踪和监控
- 链路追踪中通常涉及服务监控的配合，但是服务监控并不一定需要配合链路追踪来使用
- 链路追踪可以为运维人员提供重要的数据支持，帮助他们监控和管理系统的运行情况

#### 8.5 链路追踪的详细过程如下：

- 生成唯一标识：
  - 当一个请求进入系统时，链路追踪会为每个请求生成一个唯一的标识，通常称为请求 ID
  - 这个标识可以是一个全局唯一的字符串，也可以是一个包含时间戳和随机数的标识符
- 标识传递：
  - 随着请求在系统中不同的服务组件之间传递，请求 ID 会随之传递。每个组件在处理请求之前，会将自身的标识信息和请求 ID 传递给下一个组件，以便将请求与调用链路关联起来
- 调用关系记录：
  - 每个服务组件在处理请求时，会记录自己的标识信息、请求 ID，以及调用发起方的标识信息和请求 ID
  - 这样，就可以构建起请求的调用链路，了解请求经过的所有组件和它们之间的调用关系
- 服务监控记录：
  - 例如，请求的耗时和延迟；请求的成功率和错误率；请求的数据量和吞吐量；服务节点的健康状态 等等信息
- 注解和标签：
  - 链路追踪还支持添加注解和标签，用于描述请求的特性和上下文信息
  - 例如，可以在链路追踪中记录一个数据库查询的 SQL 语句，或者一个 HTTP 请求的路径和参数
  - 这些注解和标签可以帮助开发者更好地理解和分析请求的处理过程
- 链路追踪数据存储：
  - 链路追踪会将收集的请求调用关系、耗时记录、注解和标签等数据保存下来
  - 这些数据可以被存储在日志文件中、发送给监控系统或保存在专门的数据存储中。存储的数据可以进行长期保存，以便后续的分析和回溯
- 可视化和分析：
  - 通过链路追踪的可视化界面，可以直观地查看请求经过的组件和调用关系
  - 通常，链路追踪工具会提供图形化的调用链路图，展示请求的流向和各个组件之间的调用关系。这样，开发者可以快速定位问题、进行性能分析和异常排查

#### 8.6 链路追踪的作用

- 全链路可观察性：
  - 链路追踪通过记录请求在各个组件之间的调用关系和耗时等指标，提供了对整个请求链路的可观察性
  - 通过查看调用链路图和相关指标，可以直观地了解请求经过的组件和它们之间的调用关系，考虑优化，比如调用关系是否可以简化等
- 数据分析和优化：
  - 通过对链路追踪数据进行分析和统计，比如每个操作的开始时间和结束时间。可以发现系统中的性能瓶颈、高延迟操作和资源争用等问题，从而揭示系统的整体性能情况和瓶颈所在
  - 例通过统计每个组件的请求次数和耗时分布，可以找到最耗时和最频繁调用的组件，进一步深入研究和优化
- 问题定位：
  - 链路追踪可以记录请求处理过程中出现的异常情况。通过查看异常信息和异常发生的位置，可以追踪到异常的根源，从而快速定位和解决问题，加快故障排除的速度

## 9. 服务熔断与降级

#### 9.1 服务熔断

- 服务熔断是一种针对服务间故障的机制，通过监控服务调用的状态，当服务发生故障时，快速断开对该服务的访问，避免连锁故障并减少对故障服务的压力
- 服务熔断器会在每个服务实例上部署，以独立地监控每个实例的状态。服务熔断器的目标是快速失败和快速恢复，通过断开对故障服务的访问，避免资源浪费和长时间等待，同时也能保护服务消费者免受故障的影响
- 服务熔断器通常具有以下几个状态：
  - 关闭状态（ Closed ）：正常情况下，服务熔断器处于关闭状态，请求可以正常传递给服务
  - 打开状态（ Open ）：当服务出现故障时，服务熔断器会打开并拒绝请求，而不会将请求传递给故障的服务。此时，熔断器会暂时启用一个预先设定的错误响应，如返回缓存数据、默认值或错误提示。在打开状态下，熔断器会记录请求失败的统计信息
  - 半开状态（ Half-Open ）：经过一段时间后，服务熔断器会尝试将自身从打开状态切换到半开状态，允许部分请求通过。如果这些请求成功完成，那么熔断器会认为服务已经恢复正常，切换回关闭状态；如果请求仍然失败，那么熔断器会再次切换到打开状态。

#### 9.2 服务降级

- 服务降级是在系统资源紧张或异常情况下主动限制某些非核心功能或服务的可用性，目的是保护核心功能，避免因次要功能的问题导致整个系统崩溃。通过合理设置降级策略，并在发生异常时及时降级，可以减少资源消耗，保障系统的稳定性和可用性
- 服务降级可以采取多种策略和技术手段：
  - 返回默认值：
    - 当服务无法提供正常响应时，可以返回一个预先设定的默认值，以保证服务调用方的正常处理
  - 使用缓存数据：
    - 将服务响应的结果缓存在本地，当服务不可用时，可以使用缓存数据来提供响应，避免对服务的直接依赖
  - 简化响应内容：
    - 在异常情况下，可以返回一个简化的响应，只包含核心信息，忽略次要或非必要的信息
  - 调用备用服务：
    - 当主要服务不可用时，可以切换到备用服务提供相同或类似的功能
